# Taskfile.yml
# æ—¥å¸¸çš„ãªã‚¿ã‚¹ã‚¯ç®¡ç†ç”¨ã€‚åˆå›ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ã¯ Makefile (make bootstrap) ã‚’ä½¿ç”¨ã€‚
version: "3"

vars:
  STOW_FLAGS: -v -t ~

tasks:
  # ====================
  # ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ & ãƒ˜ãƒ«ãƒ—
  # ====================
  default:
    desc: åˆ©ç”¨å¯èƒ½ãªã‚¿ã‚¹ã‚¯ä¸€è¦§ã‚’è¡¨ç¤º
    cmds:
      - task --list

  # ====================
  # ãƒªãƒ³ã‚¯ç®¡ç†
  # ====================
  link:
    desc: å…¨ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’ãƒªãƒ³ã‚¯
    cmds:
      - task: link-shell
      - task: link-config
      - task: link-claude
      - task: link-codex

  link-shell:
    desc: ã‚·ã‚§ãƒ«è¨­å®šã‚’ãƒªãƒ³ã‚¯ (.zshrc, .zprofile)
    cmds:
      - stow {{.STOW_FLAGS}} shell

  link-config:
    desc: .config é…ä¸‹ã‚’ãƒªãƒ³ã‚¯ (wezterm, starship, mise, sheldon)
    cmds:
      - stow {{.STOW_FLAGS}} config

  link-claude:
    desc: Claude CLI ã‚’ãƒªãƒ³ã‚¯
    cmds:
      - stow {{.STOW_FLAGS}} claude

  link-codex:
    desc: Codex CLI ã‚’ãƒªãƒ³ã‚¯
    cmds:
      - stow {{.STOW_FLAGS}} codex

  # ====================
  # ãƒªãƒ³ã‚¯è§£é™¤
  # ====================
  unlink:
    desc: å…¨ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®ãƒªãƒ³ã‚¯ã‚’è§£é™¤
    cmds:
      - task: unlink-shell
      - task: unlink-config
      - task: unlink-claude
      - task: unlink-codex

  unlink-shell:
    desc: ã‚·ã‚§ãƒ«è¨­å®šã®ãƒªãƒ³ã‚¯ã‚’è§£é™¤
    cmds:
      - stow -D {{.STOW_FLAGS}} shell

  unlink-config:
    desc: .config é…ä¸‹ã®ãƒªãƒ³ã‚¯ã‚’è§£é™¤
    cmds:
      - stow -D {{.STOW_FLAGS}} config

  unlink-claude:
    desc: Claude CLI ã®ãƒªãƒ³ã‚¯ã‚’è§£é™¤
    cmds:
      - stow -D {{.STOW_FLAGS}} claude

  unlink-codex:
    desc: Codex CLI ã®ãƒªãƒ³ã‚¯ã‚’è§£é™¤
    cmds:
      - stow -D {{.STOW_FLAGS}} codex

  # ====================
  # å†ãƒªãƒ³ã‚¯ (restow)
  # ====================
  restow:
    desc: å…¨ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’å†ãƒªãƒ³ã‚¯ï¼ˆå‰Šé™¤ã—ã¦ã‹ã‚‰ä½œæˆï¼‰
    cmds:
      - stow -R {{.STOW_FLAGS}} shell config claude codex

  restow-shell:
    desc: ã‚·ã‚§ãƒ«è¨­å®šã‚’å†ãƒªãƒ³ã‚¯
    cmds:
      - stow -R {{.STOW_FLAGS}} shell

  restow-config:
    desc: .config é…ä¸‹ã‚’å†ãƒªãƒ³ã‚¯
    cmds:
      - stow -R {{.STOW_FLAGS}} config

  restow-claude:
    desc: Claude CLI ã‚’å†ãƒªãƒ³ã‚¯
    cmds:
      - stow -R {{.STOW_FLAGS}} claude

  restow-codex:
    desc: Codex CLI ã‚’å†ãƒªãƒ³ã‚¯
    cmds:
      - stow -R {{.STOW_FLAGS}} codex

  # ====================
  # ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£
  # ====================
  status:
    desc: ç¾åœ¨ã®ã‚·ãƒ³ãƒœãƒªãƒƒã‚¯ãƒªãƒ³ã‚¯çŠ¶æ…‹ã‚’ç¢ºèª
    cmds:
      - |
        echo "ğŸ“ Shell:"
        ls -la ~/.zshrc ~/.zprofile 2>/dev/null || echo "  (not linked)"
        echo ""
        echo "ğŸ“ Config:"
        ls -la ~/.config/wezterm ~/.config/starship ~/.config/mise ~/.config/sheldon 2>/dev/null || echo "  (not linked)"
        echo ""
        echo "ğŸ“ Claude:"
        ls -la ~/.claude 2>/dev/null || echo "  (not linked)"
        echo ""
        echo "ğŸ“ Codex:"
        ls -la ~/.codex 2>/dev/null || echo "  (not linked)"

  brew:
    desc: Homebrew ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
    cmds:
      - brew bundle --file={{.ROOT_DIR}}/Brewfile

  edit:
    desc: dotfiles ã‚’ VS Code ã§é–‹ã
    cmds:
      - code ~/.dotfiles
